<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>BetSense Ultra – USI Test & Live Connect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Tailwind CDN فقط برای استایل فرانت -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="min-h-screen bg-slate-950 text-slate-50 flex items-center justify-center p-4"
  >
    <div
      class="max-w-3xl w-full bg-slate-900/60 border border-slate-800 rounded-3xl p-6 md:p-8 shadow-xl space-y-10"
    >
      <!-- بخش ۱: USI Test Console -->
      <section class="space-y-4">
        <h1 class="text-2xl md:text-3xl font-semibold">
          Ultra Security Intelligence (USI) – Test Console
        </h1>
        <p class="text-slate-300 text-sm md:text-base leading-relaxed">
          Click the button below to send a sample request to the USI engine
          (Real Madrid vs Barcelona).
        </p>

        <button
          id="usi-test-btn"
          class="px-5 py-2.5 rounded-full bg-emerald-500 text-slate-950 font-semibold text-sm md:text-base hover:bg-emerald-400 active:scale-95 transition"
        >
          Run USI Test
        </button>

        <pre
          id="usi-output"
          class="mt-4 bg-slate-950/60 border border-slate-800 rounded-2xl p-4 text-xs md:text-sm overflow-x-auto"
        >
{
  "securityStatus": "PASS",
  "riskScore": "0.12",
  "analyzedTeams": [
    "Real Madrid",
    "Barcelona"
  ],
  "timestamp": "2025-12-07T07:11:40.665Z",
  "signature": "demo-signature"
}</pre
        >
      </section>

      <!-- بخش ۲: Live Connected Data (Global Partner Connect) -->
      <section class="space-y-4 border-t border-slate-800 pt-6 md:pt-8">
        <h2 class="text-xl md:text-2xl font-semibold">
          Live Connected Data – Partner Connect Demo
        </h2>
        <p class="text-slate-300 text-sm md:text-base leading-relaxed">
          This button sends a generic live-connect payload to the BetSense
          Live Connected Data server. Any partner can plug their own live data
          into this endpoint with a schema-agnostic JSON payload.
        </p>

        <button
          id="live-connect-btn"
          class="px-5 py-2.5 rounded-full bg-sky-500 text-slate-950 font-semibold text-sm md:text-base hover:bg-sky-400 active:scale-95 transition"
        >
          Send Live Connect Ping
        </button>

        <pre
          id="live-connect-output"
          class="mt-4 bg-slate-950/60 border border-slate-800 rounded-2xl p-4 text-xs md:text-sm overflow-x-auto"
        >
// Live Connected Data response will appear here…</pre
        >
      </section>
    </div>

    <!-- اسکریپت تست USI -->
    <script>
      const USI_URL = "https://betsense-usi.onrender.com/api/usi";

      const usiBtn = document.getElementById("usi-test-btn");
      const usiOutput = document.getElementById("usi-output");

      usiBtn.addEventListener("click", async () => {
        usiBtn.disabled = true;
        const originalText = usiBtn.innerText;
        usiBtn.innerText = "Running…";

        const payload = {
          teamA: "Real Madrid",
          teamB: "Barcelona",
          confidence: 0.88,
        };

        usiOutput.textContent = "// Sending request to USI engine…";

        try {
          const res = await fetch(USI_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          const json = await res.json();
          usiOutput.textContent = JSON.stringify(json, null, 2);
        } catch (err) {
          usiOutput.textContent =
            "// USI error:\\n" + (err && err.message ? err.message : String(err));
        } finally {
          usiBtn.disabled = false;
          usiBtn.innerText = originalText;
        }
      });
    </script>

    <!-- اسکریپت Live Connected Data (ماژول) -->
    <script type="module">
      import { initLiveConnectedDataButton } from "./components/LiveConnectedDataButton.js";

      initLiveConnectedDataButton({
        buttonId: "live-connect-btn",
        outputId: "live-connect-output",
      });
    </script>
  </body>
</html>
