<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>BetSense – Genius Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Genius Engine – smart signal layer on top of BetSense Emotion · xG · Orderbook · Quantum stack."
    />

    <style>
      :root {
        --bg-deep: #020617;
        --bg-card: rgba(15, 23, 42, 0.96);
        --bg-pill: rgba(15, 23, 42, 0.85);
        --border-soft: rgba(148, 163, 184, 0.4);
        --border-strong: rgba(56, 189, 248, 0.9);
        --accent-blue: #38bdf8;
        --accent-green: #22c55e;
        --accent-purple: #a855f7;
        --text-main: #e5e7eb;
        --text-muted: #9ca3af;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: radial-gradient(
            circle at top,
            rgba(56, 189, 248, 0.28),
            transparent 55%
          ),
          radial-gradient(
            circle at bottom,
            rgba(168, 85, 247, 0.18),
            transparent 55%
          ),
          var(--bg-deep);
        color: var(--text-main);
      }

      body {
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
      }

      .page {
        width: 100%;
        max-width: 480px;
        padding: 20px 16px 32px;
      }

      .badge-suite {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.5);
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: var(--text-muted);
        margin-bottom: 8px;
      }

      .badge-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: radial-gradient(circle, #22c55e, #15803d);
      }

      .hero-title {
        font-size: 1.35rem;
        font-weight: 650;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        margin: 0 0 4px;
      }

      .hero-sub {
        font-size: 0.82rem;
        color: var(--text-muted);
        margin-bottom: 18px;
        max-width: 360px;
      }

      .hero-sub span {
        color: var(--accent-blue);
      }

      .pill-mode {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 3px 9px;
        border-radius: 999px;
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.5);
        color: var(--text-muted);
        margin-bottom: 10px;
      }

      .pill-mode strong {
        color: var(--accent-purple);
      }

      .card {
        background: var(--bg-card);
        border-radius: 20px;
        padding: 18px 16px;
        border: 1px solid rgba(148, 163, 184, 0.45);
        box-shadow: 0 22px 60px rgba(15, 23, 42, 0.9);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        align-items: center;
        margin-bottom: 10px;
      }

      .card-title {
        font-size: 0.95rem;
        font-weight: 600;
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }

      .card-tag {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.14em;
        color: var(--text-muted);
      }

      .card-tag span {
        color: var(--accent-blue);
      }

      .card-body {
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-bottom: 14px;
      }

      .divider {
        height: 1px;
        width: 100%;
        background: linear-gradient(
          to right,
          transparent,
          rgba(148, 163, 184, 0.6),
          transparent
        );
        margin: 10px 0 14px;
      }

      .form-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 8px;
      }

      label {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-bottom: 3px;
        display: block;
      }

      .field-group {
        display: flex;
        flex-direction: column;
      }

      input {
        width: 100%;
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid rgba(55, 65, 81, 0.9);
        background: rgba(2, 6, 23, 0.95);
        color: var(--text-main);
        font-size: 0.8rem;
        outline: none;
      }

      input::placeholder {
        color: #6b7280;
      }

      .row-odds {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 6px;
      }

      button {
        width: 100%;
        padding: 9px 12px;
        border-radius: 999px;
        border: none;
        font-size: 0.85rem;
        font-weight: 600;
        cursor: pointer;
        margin-top: 10px;
      }

      .btn-main {
        background: linear-gradient(135deg, #22c55e, #a3e635);
        color: #022c22;
      }

      .btn-outline {
        background: transparent;
        border: 1px solid rgba(148, 163, 184, 0.6);
        color: var(--text-main);
      }

      .status {
        margin-top: 8px;
        font-size: 0.78rem;
        color: var(--text-muted);
        min-height: 18px;
      }

      .status.ok {
        color: #4ade80;
      }

      .status.error {
        color: #f97373;
      }

      .result-card {
        margin-top: 12px;
        padding: 10px;
        border-radius: 14px;
        border: 1px solid rgba(45, 212, 191, 0.5);
        background: radial-gradient(
            circle at top left,
            rgba(45, 212, 191, 0.2),
            transparent 55%
          ),
          rgba(6, 78, 59, 0.25);
        font-size: 0.78rem;
      }

      .result-header {
        display: flex;
        justify-content: space-between;
        font-size: 0.78rem;
        margin-bottom: 4px;
      }

      .badge-engine {
        padding: 2px 8px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.6);
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: var(--text-muted);
      }

      .rec-value {
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.14em;
      }

      .rec-value span {
        color: var(--accent-green);
      }

      .meta-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 2px;
      }

      .note-tags {
        margin-top: 4px;
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
      }

      .tag {
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.5);
        background: rgba(15, 23, 42, 0.95);
        font-size: 0.7rem;
        color: var(--text-muted);
      }

      pre {
        margin-top: 8px;
        max-height: 220px;
        overflow: auto;
        background: rgba(15, 23, 42, 0.95);
        border-radius: 10px;
        padding: 8px;
        font-size: 0.7rem;
        color: var(--text-main);
      }

      .footnote {
        margin-top: 10px;
        font-size: 0.7rem;
        color: var(--text-muted);
      }

      .footnote span {
        color: var(--accent-blue);
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="badge-suite">
        <span class="badge-dot"></span>
        BetSense AI Stack · Genius Layer
      </div>

      <h1 class="hero-title">Genius Engine</h1>
      <p class="hero-sub">
        Smart signal layer on top of your existing
        <span>Emotion · xG · Orderbook · Quantum</span> stack. This page is a
        lightweight console to test the backend API.
      </p>

      <div class="pill-mode">
        <span>Feed · Pre-trade & In-play</span>
      </div>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Signal Request</div>
            <div class="card-tag">
              Stack · <span>Genius</span>
            </div>
          </div>
        </div>

        <div class="card-body">
          Send a single-fixture snapshot to Genius Engine and preview the mock
          recommendation and confidence. Production feeds plug into this layer
          via API or WebSocket.
        </div>

        <div class="divider"></div>

        <div class="form-grid">
          <div class="field-group">
            <label for="fixtureId">Fixture ID (optional)</label>
            <input
              id="fixtureId"
              type="text"
              placeholder="Example: 123456"
              autocomplete="off"
            />
          </div>

          <div class="field-group">
            <label for="homeTeam">Home team (optional)</label>
            <input
              id="homeTeam"
              type="text"
              placeholder="Example: Arsenal"
              autocomplete="off"
            />
          </div>

          <div class="field-group">
            <label for="awayTeam">Away team (optional)</label>
            <input
              id="awayTeam"
              type="text"
              placeholder="Example: Spurs"
              autocomplete="off"
            />
          </div>

          <div class="field-group">
            <label>Odds – home / draw / away (optional)</label>
            <div class="row-odds">
              <input
                id="oddsHome"
                type="number"
                step="0.01"
                placeholder="1.85"
              />
              <input
                id="oddsDraw"
                type="number"
                step="0.01"
                placeholder="3.60"
              />
              <input
                id="oddsAway"
                type="number"
                step="0.01"
                placeholder="4.20"
              />
            </div>
          </div>
        </div>

        <button class="btn-main" id="analyzeBtn">Run Genius Analyze</button>
        <button class="btn-outline" id="healthBtn">
          Check Genius health
        </button>

        <div id="status" class="status"></div>

        <div id="resultBox" class="result-card" style="display: none">
          <div class="result-header">
            <div class="rec-value">
              Recommendation: <span id="recText">–</span>
            </div>
            <div class="badge-engine">Mode · Mock</div>
          </div>
          <div class="meta-row">
            <span>Confidence</span>
            <span id="confText">–</span>
          </div>
          <div class="note-tags" id="notesBox"></div>
          <pre id="rawJson"></pre>
        </div>

        <div class="footnote">
          All values on this page are illustrative. Production feeds plug into
          this layer via <span>API</span> or <span>WebSocket</span>.
        </div>
      </div>
    </div>

    <script>
      const API_BASE = "https://betsense-backend.onrender.com";

      const fixtureIdInput = document.getElementById("fixtureId");
      const homeTeamInput = document.getElementById("homeTeam");
      const awayTeamInput = document.getElementById("awayTeam");
      const oddsHomeInput = document.getElementById("oddsHome");
      const oddsDrawInput = document.getElementById("oddsDraw");
      const oddsAwayInput = document.getElementById("oddsAway");

      const analyzeBtn = document.getElementById("analyzeBtn");
      const healthBtn = document.getElementById("healthBtn");
      const statusEl = document.getElementById("status");
      const resultBox = document.getElementById("resultBox");
      const recText = document.getElementById("recText");
      const confText = document.getElementById("confText");
      const notesBox = document.getElementById("notesBox");
      const rawJson = document.getElementById("rawJson");

      const setStatus = (msg, type = "") => {
        statusEl.textContent = msg || "";
        statusEl.className = "status " + type;
      };

      const showResult = (payload) => {
        if (!payload || !payload.data) {
          resultBox.style.display = "none";
          return;
        }

        const { result } = payload.data;

        resultBox.style.display = "block";

        if (result && result.recommendation) {
          recText.textContent = result.recommendation;
        } else {
          recText.textContent = "–";
        }

        if (result && typeof result.confidence === "number") {
          confText.textContent = Math.round(result.confidence * 100) + "%";
        } else {
          confText.textContent = "–";
        }

        notesBox.innerHTML = "";
        if (result && Array.isArray(result.notes)) {
          result.notes.forEach((note) => {
            const span = document.createElement("span");
            span.className = "tag";
            span.textContent = note;
            notesBox.appendChild(span);
          });
        }

        rawJson.textContent = JSON.stringify(payload, null, 2);
      };

      healthBtn.addEventListener("click", async () => {
        try {
          setStatus("Checking Genius health…");
          resultBox.style.display = "none";

          const res = await fetch(`${API_BASE}/api/genius/health`);
          const data = await res.json();

          if (data.ok) {
            setStatus("Genius Engine is ONLINE", "ok");
          } else {
            setStatus("Genius Engine returned an error.", "error");
          }

          rawJson.textContent = JSON.stringify(data, null, 2);
          resultBox.style.display = "block";
        } catch (err) {
          console.error(err);
          setStatus("Error connecting to backend.", "error");
        }
      });

      analyzeBtn.addEventListener("click", async () => {
        try {
          setStatus("Running Genius analyze…");
          resultBox.style.display = "none";

          const params = new URLSearchParams();

          if (fixtureIdInput.value.trim()) {
            params.append("fixtureId", fixtureIdInput.value.trim());
          }
          if (homeTeamInput.value.trim()) {
            params.append("homeTeam", homeTeamInput.value.trim());
          }
          if (awayTeamInput.value.trim()) {
            params.append("awayTeam", awayTeamInput.value.trim());
          }
          if (oddsHomeInput.value.trim()) {
            params.append("oddsHome", oddsHomeInput.value.trim());
          }
          if (oddsDrawInput.value.trim()) {
            params.append("oddsDraw", oddsDrawInput.value.trim());
          }
          if (oddsAwayInput.value.trim()) {
            params.append("oddsAway", oddsAwayInput.value.trim());
          }

          const url =
            `${API_BASE}/api/genius/analyze` +
            (params.toString() ? `?${params.toString()}` : "");

          const res = await fetch(url);
          const data = await res.json();

          if (data.ok) {
            setStatus("Genius analyze completed", "ok");
          } else {
            setStatus("Genius analyze returned an error.", "error");
          }

          showResult(data);
        } catch (err) {
          console.error(err);
          setStatus("Error running Genius analyze.", "error");
        }
      });
    </script>
  </body>
</html>
